% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mc_ms.R
\name{mcms_fit}
\alias{mcms_fit}
\title{This function is used to estimate the MCNNM model with given lambda values for L,H, and b.
If post_estimation is set, then the estimated parameters are returned additionally in the list.}
\usage{
mcms_fit(
  M,
  mask,
  lambda_L,
  lambda_H = 0,
  lambda_b = 0,
  X = NA,
  Z = NA,
  B = NA,
  num_B_cov = NA,
  to_add_ID = TRUE,
  to_estimate_u = TRUE,
  to_estimate_v = TRUE,
  to_estimate_b = TRUE,
  to_estimate_H = TRUE,
  niter = 100,
  rel_tol = 1e-05,
  to_normalize = TRUE,
  is_quiet = FALSE,
  post_estimation = TRUE,
  impose_null = TRUE,
  permutation_inference = "all",
  permutation_max = 1000
)
}
\arguments{
\item{M}{Outcome matrix}

\item{mask}{Treatment mask matrix (1 if control, 0 if treated)}

\item{lambda_L}{lambda value for rank-regularization}

\item{lambda_H}{lambda value for unit and time covariate linking matrix regularization}

\item{lambda_b}{lambda value for unit-time covariate regularization}

\item{X}{Units covariate matrix (Time-invariant)}

\item{Z}{Time covariate matrix (Unit-invariant)}

\item{B}{Unit-Time covariate matrix}

\item{num_B_cov}{Number of unit-time covariates}

\item{to_add_ID}{Whether to add an identity matrix to the X and Z matrices. (default: TRUE)}

\item{to_estimate_u}{Whether to estimate the units' fixed effects. (default: TRUE)}

\item{to_estimate_v}{Whether to estimate the time's fixed effects. (default: TRUE)}

\item{to_estimate_b}{Whether to estimate the unit-time varying covariate parameters. (default: TRUE)}

\item{to_estimate_H}{Whether to estimate the unit and time covariates linking parameters. (default: TRUE)}

\item{niter}{Number of iterations for the coordinate descent steps. (default: 100)}

\item{rel_tol}{Relative tolerance for the convergence of the coordinate descent steps. (default: 1e-5)}

\item{to_normalize}{Whether to normalize the X, Z, and B matrices. (default: TRUE)}

\item{is_quiet}{Whether to print the progress of the algorithm. (default: FALSE)}

\item{post_estimation}{Whether a post regularization estimation without regularization should be estimated}

\item{impose_null}{Whether null-hypothesis should be imposed. Implies that all observations also treated observations are used in model estimation. (default: TRUE)}

\item{permutation_inference}{Permutation setting for inference procedure. Either "block-moving" under stationarity assumption, "all" under iid assumption or NA if no inference procedure should be executed. Is only possible if impose_null is set to TRUE. (default: "all")}

\item{permutation_max}{Maximum of evaluated permutations. If NA, all possible permutations are considered (default: NA)}
}
\value{
: List containing the following elements:
	    - "u": Estimated units' fixed effects
		- "v": Estimated time's fixed effects
		- "B": Estimated unit-time covariates' coefficients
		- "H": Estimated H matrix
		- "tau": The estimate of the treatment effect
		- "tau_rot": Rule-of-thumb corrected estimate of the treatment effect
		- "lambda_L": Estimated lambda_L value
		- "lambda_H": Estimated lambda_H value
		- "lambda_b": Estimated lambda_b value
}
\description{
This function is used to estimate the MCNNM model with given lambda values for L,H, and b.
If post_estimation is set, then the estimated parameters are returned additionally in the list.
}
\examples{
mcms_fit(M, X, Z, B, mask, lambda_L, lambda_H, lambda_b, num_B_cov)
}
